var sides={StarFighter:0,Enemy:1};function Bullet(x,y,xSpeed,ySpeed,type,damage,side){var side=side;var damage=damage;var type=type;var xSpeed=parseInt(xSpeed);var ySpeed=parseInt(ySpeed);var me=this;var isEnemy=isEnemy;var visible=true;var width=5;var height=1;var x=parseInt(x);var y=Math.floor(parseInt(y)-height/2);var bullet=$('<div class="Bullet"></div>');var sinCounter=Math.ceil(Math.random()*100);(function(){if(type==1||type==2)height=5;if(xSpeed>0)x+=width+Math.ceil(xSpeed/4);else x-=width+Math.ceil(xSpeed/4);if(side==sides["StarFighter"])bullet.css("background-color","#AAFF11");else bullet.css("background-color","#f11226");bullet.css("width",width);bullet.css("height",height);bullet.css("top",y);bullet.css("left",x)})();this.animate=function(){x+=xSpeed;y+=ySpeed;if(x<0||x>canvas.getWidth()){remove();return}if(y<0||y>canvas.getHeight()){remove();return}if(type==0||type==2){bullet.css("top",y)}else if(type==1){sinCounter=(sinCounter+1)%100;bullet.css("top",y+20*Math.sin(sinCounter))}bullet.css("left",x)};this.isVisible=function(){return visible};this.getDomObject=function(){return bullet};this.getType=function(){return"Bullet"};var remove=function(){bullet.remove();visible=false};this.kill=remove;this.destroy=remove;this.getDimensions=function(){return{0:new Rectangle(y,y+height,x,x+width)}};this.getDamage=function(){return damage};this.getSide=function(){return side}}function Canvas(width,height){var width=parseInt(width);var height=parseInt(height);var objects={};var size=0;var canvas=$('<div class="Canvas"></div>');var desiredFps=70;var fps=0;var fpsDisplay=$('<div class="Fps"></div>');var collisionDetector=new CollisionDetector(width,height);var me=this;var date=new Date;var displayFps=function(){fpsDisplay.html("FPS: "+fps);fps=0;setTimeout(displayFps,1e3)};var animate=function(){var startTime=date.getTime();for(var index in objects){if(objects[index].isVisible())objects[index].animate();else delete objects[index]}collisionDetector.handleCollisions(objects);fps++;var endTime=date.getTime();var elapsedTime=endTime-startTime;var delayTime=Math.max(0,1e3/desiredFps-elapsedTime);setTimeout(animate,delayTime)};(function(){canvas.css("width",width);canvas.css("height",height);$(mainContainer).css("width",width);$(mainContainer).css("height",height);$(mainContainer).append(canvas);$(mainContainer).append(fpsDisplay);animate();if(navigator.appName=="Microsoft Internet Explorer")desiredFps=desiredFps*2;displayFps()})();this.getCanvas=function(){return canvas};this.getWidth=function(){return width};this.getHeight=function(){return height};this.setWidth=function(value){width=value};this.setHeight=function(value){height=value};this.append=function(object){objects[size]=object;canvas.append(object.getDomObject());return size++};this.setTitleBar=function(object){objects[size]=object;$(mainContainer).prepend(object.getDomObject);return size++};this.getType=function(){return"Canvas"};this.getObject=function(type){for(var index in objects)if(objects[index].getType()==type)return objects[index];return null};this.getObjects=function(type){var ret={};for(var index in objects)if(objects[index].getType()==type||typeof type=="undefined")ret[index]=objects[index];return ret};this.killAll=function(){for(var index in objects)if(objects[index].isVisible())objects[index].destroy()}}function Circle(center,radius){var center=center;var radius=Math.ceil(radius);var isColiding=function(shape){var type=shape.getType();if(type=="Rectangle"||type=="Triangle"){var points=shape.getPoints();for(var point in points)if(isColiding(points[point]))return true}else if(type=="Circle")return distance(center,shape.getCenter())<=radius+shape.getRadius();else if(type=="Point")return distance(center,shape)<=radius;return false};this.intersects=isColiding;this.getRadius=function(){return radius};this.getCenter=function(){return center};this.getType=function(){return"Circle"}}function CollisionDetector(canvasWidth,canvasHeight){var gridFactor=20;var height=Math.ceil(canvasHeight/gridFactor);var width=Math.ceil(canvasWidth/gridFactor);var grid;this.handleCollisions=function(objects){grid={};for(var object in objects){var shapes={};var objectType=objects[object].getType();if(objectType=="StarFighter"||objectType=="Enemy"||objectType=="Bullet"||objectType=="PowerUp")shapes=objects[object].getDimensions();for(var shape in shapes){var type=shapes[shape].getType();if(type=="Rectangle"){var rectangle=shapes[shape];var top=Math.floor(rectangle.getTop()/gridFactor);var bottom=Math.floor(rectangle.getBottom()/gridFactor);var left=Math.floor(rectangle.getLeft()/gridFactor);var right=Math.floor(rectangle.getRight()/gridFactor);var x;var y;for(x=Math.max(0,left);x<=Math.min(width,right);x++)for(y=Math.max(0,top);y<=Math.min(height,bottom);y++)setGrid(x,y,object,objects[object])}else if(type=="Triangle"){var triangle=shapes[shape];var points=triangle.getPoints();var smallestX=canvas.getWidth();var largestX=0;var smallestY=canvas.getHeight();var largestY=0;for(var point in points){smallestX=Math.min(points[point].getX(),smallestX);largestX=Math.max(points[point].getX(),largestX);smallestY=Math.min(points[point].getY(),smallestY);largestY=Math.max(points[point].getY(),largestY)}smallestX=Math.max(0,Math.floor(smallestX/gridFactor));largestX=Math.min(Math.floor(largestX/gridFactor),width);smallestY=Math.max(0,Math.floor(smallestY/gridFactor));largestY=Math.min(Math.floor(largestY/gridFactor),height);var x;var y;for(x=smallestX;x<=largestX;x++)for(y=smallestY;y<=largestY;y++)setGrid(x,y,object,objects[object])}else if(type=="Circle"){var circle=shapes[shape];var center=circle.getCenter();var centerX=center.getX();var centerY=center.getY();var radius=circle.getRadius();var top=Math.floor((centerY-radius)/gridFactor);var bottom=Math.floor((centerY+radius)/gridFactor);var left=Math.floor((centerX-radius)/gridFactor);var right=Math.floor((centerX+radius)/gridFactor);var x;var y;for(x=Math.max(0,left);x<Math.min(width,right);x++)for(y=Math.max(0,top);y<Math.min(height,bottom);y++)if(circle.intersects(new Rectangle(top*gridFactor,bottom*gridFactor,left*gridFactor,right*gridFactor)))setGrid(x,y,object,objects[object])}}}for(var x in grid)for(var y in grid[x])colide(grid[x][y])};var setGrid=function(x,y,key,value){if(x<0||y<0||x>width||y>height)return;if(typeof grid[x]=="undefined"){grid[x]={};grid[x][y]={}}else if(typeof grid[x][y]=="undefined"){grid[x][y]={}}grid[x][y][key]=value};var colide=function(objects){var starFighter=getObject(objects,"StarFighter");var enemies=getObjects(objects,"Enemy");var bullets=getObjects(objects,"Bullet");var powerUps=getObjects(objects,"PowerUp");for(var index in enemies){var enemy=enemies[index];if(starFighter!=null&&isColiding(enemy,starFighter)){starFighter.kill();enemy.kill()}for(var bullet in bullets)if(bullets[bullet].getSide()==sides["StarFighter"]&&isColiding(bullets[bullet],enemy)){enemy.damage(bullets[bullet].getDamage());bullets[bullet].kill()}}if(starFighter==null)return;for(var index in bullets){var bullet=bullets[index];if(bullet.getSide()==sides["Enemy"]&&isColiding(bullet,starFighter)){starFighter.damage(bullet.getDamage());bullet.kill()}}for(var index in powerUps){var powerUp=powerUps[index];if(isColiding(powerUp,starFighter)){starFighter.setPowerUp(powerUp);powerUp.kill()}}};var isColiding=function(object1,object2){if(!object1.isVisible()||!object2.isVisible())return false;var dim1=object1.getDimensions();var dim2=object2.getDimensions();for(var o1 in dim1)for(var o2 in dim2)if(dim1[o1].intersects(dim2[o2])||dim2[o2].intersects(dim1[o1]))return true;return false};var getObject=function(objects,type){for(var index in objects)if(objects[index].getType()==type)return objects[index];return null};var getObjects=function(objects,type){var ret={};for(var index in objects)if(objects[index].getType()==type||typeof type=="undefined")ret[index]=objects[index];return ret}}$(document).ready(function(){new TitleScreen});var enemies={0:{width:40,height:29,type:"Basic",speed:2,health:10,damage:5,points:5},1:{width:64,height:15,type:"2",speed:4,health:20,damage:10,points:10},2:{width:64,height:15,type:"2",speed:5,health:30,damage:15,points:20}};function Enemy(y,type){var getTimeout=function(){return Math.floor(Math.random()*5e3)+1e3};var side=1;var firingTimeout=getTimeout();var data=enemies[type];var maxHealth=data["health"];var health=maxHealth;var width=data["width"];var points=data["points"];var damage=data["damage"];var height=data["height"];var x=canvas.getWidth();var y=parseInt(y);var type=data["type"];var speed=data["speed"];var visible=true;var enemy=$('<div class="Enemy"></div>');var image=$('<img src="'+URL+"Enemy"+type+'.png" width="'+width+'px" height="'+height+'px" />');var fire=function(){if(!visible)return;firingTimeout=getTimeout();var starFighter=canvas.getObject("StarFighter");if(starFighter==null)return;var xTarget;var yTarget;var starFighterDimensions=starFighter.getDimensions();for(var shape in starFighterDimensions){var rectangle=starFighterDimensions[shape];var type=rectangle.getType();if(type=="Rectangle"){xTarget=(rectangle.getLeft()+rectangle.getRight())/2;yTarget=(rectangle.getTop()+rectangle.getBottom())/2}}var xSource=x;var ySource=y+Math.ceil(height/2);var rise=ySource-yTarget;var run=xSource-xTarget;var bulletSpeed=Math.floor(-1.5*speed);var slope=0;if(run!=0&&Math.abs(rise/run)<.75)slope=Math.ceil(bulletSpeed*rise/run);canvas.append(new Bullet(x,y+Math.floor(width/2),bulletSpeed,slope,2,damage,side));setTimeout(fire,firingTimeout)};(function(){setTimeout(fire,firingTimeout);enemy.append(image);enemy.css("height",height);enemy.css("width",width);enemy.css("left",x);enemy.css("top",y)})();this.getBullets=function(){return{}};this.animate=function(){x-=speed;if(x<0){visible=false;enemy.remove();return}enemy.css("left",x)};this.getDomObject=function(){return enemy};this.isVisible=function(){return visible};this.getType=function(){return"Enemy"};var remove=function(){enemy.remove();visible=false};var kill=function(){remove();var starFighter=canvas.getObject("StarFighter");if(starFighter!=null)starFighter.addScore(points);canvas.append(new Explosion(x,y,function(x,y){var powerUpRate=6;if(Math.floor(Math.random()*powerUpRate)==0)canvas.append(new PowerUp(x,y))}))};this.kill=kill;this.destroy=remove;this.getDimensions=function(){return{0:new Rectangle(y,y+height,x,x+width)}};this.damage=function(damage){health-=damage;if(health<=0)kill()};this.getSide=function(){return side}}function Explosion(x,y,callBack){var callBack=callBack;var me=this;var x=parseInt(x);var y=parseInt(y);var height=32;var width=32;var animation=0;var explosion=$('<div class="Explosion"></div>');var speed=2;var images={0:$('<img src="'+URL+'Explosion1.png" width="'+width+'" height="'+height+'" />'),1:$('<img src="'+URL+'Explosion2.png" width="'+width+'" height="'+height+'" />'),2:$('<img src="'+URL+'Explosion3.png" width="'+width+'" height="'+height+'" />')};var visible=true;(function(){if(typeof callBack!="function")callBack=function(x,y){};for(var index in images){images[index].css("display","none");explosion.append(images[index])}explosion.css("position","absolute");explosion.css("left",x);explosion.css("top",y);explosion.css("width",width);explosion.css("height",height)})();this.animate=function(){animation++;for(var index in images)if(index==Math.floor(animation/10)%3)images[index].css("display","block");else images[index].css("display","none");x-=speed;if(x<0)remove();else if(animation>30){remove();callBack(x,y)}else explosion.css("left",x)};this.kill=function(){remove()};var remove=function(){explosion.remove();explosion=null;visible=false};this.destroy=remove;this.isVisible=function(){return visible};this.getType=function(){return"Explosion"};this.getDomObject=function(){return explosion};this.getDimensions=function(){return{0:new Circle(new Point(Math.floor(x+width/2),Math.floor(y+height)),Math.ceil(width/2))}}}function Font(point,string,fontSize,css,onClick){var css=css;var onClick=onClick;var fontSize=fontSize;var point=point;var string=string;var font=$('<div class="Font"></div>');(function(){if(typeof onClick!="function")onClick=function(){};font.html(string);font.css("top",point.getY());font.css("left",point.getX());font.css("line-height",fontSize+"px");font.css("font-size",fontSize+"px");for(var index in css)font.css(index,css[index]);font.css("position","absolute");font.css("cursor","pointer");font.click(onClick)})();this.isVisible=function(){return true};this.animate=function(){};var remove=function(){font.remove();font=null};this.kill=remove;this.destroy=remove;this.getType=function(){return"Font"};this.animate=function(){};this.getDomObject=function(){return font}}var canvas=null;var collisionDetector=null;var titleBar=null;function Game(){(function(){if(canvas!=null)canvas.killAll();canvas=new Canvas(RESOLUTION_WIDTH,RESOLUTION_HEIGHT);new Stars(canvas);canvas.append(new StarFighter);canvas.append(new Scroller);canvas.setTitleBar(new TitleBar)})()}function distance(point1,point2){var x1=point1.getX();var y1=point1.getY();var x2=point1.getX();var y2=point1.getY();var x=x1-x2;var y=y1-y1;return x*x+y*y}function Point(x,y){var x=Math.floor(x);var y=Math.floor(y);this.getX=function(){return x};this.getY=function(){return y};this.getType=function(){return"Point"}}var powerUps={size:3,0:{type:"Speed",height:32,width:32,speed:2},1:{type:"Bomb",height:32,width:32,speed:2},2:{type:"Fire",height:32,width:32,speed:2}};function PowerUp(x,y){var me=this;var data=powerUps[Math.floor(Math.random()*powerUps["size"])];var x=parseInt(x);var y=parseInt(y);var powerUp=$('<div class="PowerUp"><img src="'+URL+"PowerUp"+data.type+'.png" width="'+data.width+'" height="'+data.height+'" /></div>');var visible=true;(function(){powerUp.css("position","absolute");powerUp.css("left",x);powerUp.css("top",y);powerUp.css("width",data.width);powerUp.css("height",data.height)})();this.animate=function(){x-=data.speed;if(x<0)remove();else powerUp.css("left",x)};var remove=function(){powerUp.remove();visible=false};this.kill=remove;this.destroy=remove;this.isVisible=function(){return visible};this.getType=function(){return"PowerUp"};this.getDomObject=function(){return powerUp};this.getPowerUpType=function(){return data.type};this.getDimensions=function(){return{0:new Circle(new Point(Math.floor(x+data.width/2),Math.floor(y+data.height)),Math.ceil(data.width/2))}}}function Rectangle(top,bottom,left,right){var me=this;var top=top;var bottom=bottom;var right=right;var left=left;var topLeft=new Point(left,top);var topRight=new Point(right,top);var bottomLeft=new Point(left,bottom);var bottomRight=new Point(right,bottom);var isColiding=function(shape){var type=shape.getType();if(type!="Point"){var points=getPoints();for(var point in points)if(shape.intersects(points[point]))return true}if(type=="Rectangle"||type=="Triangle"){var points=shape.getPoints();for(var point in points)if(isColiding(points[point]))return true}else if(type=="Cricle")return shape.intersects(me);else if(type=="Point"){var x=shape.getX();var y=shape.getY();return left<=x&&right>=x&&top<=y&&bottom>=y}return false};this.intersects=isColiding;this.getType=function(){return"Rectangle"};var getPoints=function(){return{0:topLeft,1:topRight,2:bottomLeft,3:bottomRight}};this.getPoints=getPoints;this.getTop=function(){return top};this.getBottom=function(){return bottom};this.getLeft=function(){return left};this.getRight=function(){return right}}function Scroller(){var x=0;var speed=3;var size=0;var visible=true;this.animate=function(){x+=speed;while(enemyList[size]!=null&&enemyList[size]["x"]<=x){var data=enemyList[size++];canvas.append(new Enemy(data["y"],data["type"]))}};this.destroy=function(){size=0;x=0;visible=false};this.getDomObject=function(){return null};this.isVisible=function(){return visible};this.getType=function(){return"Scroller"}}function Stars(canvas){var canvas=canvas;(function(){var i=0;while(i++<50)canvas.append(new Star)})();function Star(){var maxSpeed=25;var x=Math.floor(Math.random()*canvas.getWidth());var y;var speed;var star=$('<div class="Star"></div>');var visible=true;var newY=function(){return Math.floor(Math.random()*canvas.getHeight())};var newSpeed=function(){if(speed>maxSpeed*2/3){star.css("width",3);star.css("height",3)}else if(speed>maxSpeed/3){star.css("width",2);star.css("height",2)}else{star.css("width",1);star.css("height",1)}return Math.ceil(Math.random()*maxSpeed)};(function(){y=newY();speed=newSpeed();star.css("top",y);star.css("left",x)})();this.animate=function(){x-=speed;if(x<0){x=canvas.getWidth();y=newY();speed=newSpeed();star.css("top",y)}star.css("left",x)};this.getDomObject=function(){return star};this.isVisible=function(){return visible};this.getType=function(){return"Star"};this.destroy=function(){star.remove();star=null;visible=false}}}function StarFighter(){var score=0;var damage=15;var visible=true;var fireDelay=150;var width=64;var height=64;var x=0;var y=Math.floor((canvas.getHeight()-height)/2);var speed=3;var fighter=$('<div class="StarFighter"></div>');var image=$('<img class="StarFighter" width="'+width+'px" height="'+height+'px" src="'+URL+'StarFighter.png" />');var firing=false;var bullets={};var size=0;var fireType=0;var maxHealth=25;var health=maxHealth;var side=0;var keys={13:false,97:false,65:false,97:false,119:false,68:false,100:false,83:false,115:false};var fire=function(){if(firing)return;firing=true;if(fireType==0){bullets[size]=new Bullet(x+width,Math.floor(y+height/2),speed*3,0,0,damage,side);canvas.append(bullets[size++])}else if(fireType==1){bullets[size]=new Bullet(x+width,Math.floor(y+height/2)+3,speed*3,0,0,damage,side);canvas.append(bullets[size++]);bullets[size]=new Bullet(x+width,Math.floor(y+height/2)-3,speed*3,0,0,damage,side);canvas.append(bullets[size++])}else if(fireType==2){bullets[size]=new Bullet(x+width,Math.floor(y+height/2),speed*3,-5,0,damage,side);canvas.append(bullets[size++]);bullets[size]=new Bullet(x+width,Math.floor(y+height/2),speed*3,5,0,damage,side);canvas.append(bullets[size++])}else if(fireType==3){bullets[size]=new Bullet(x+width,Math.floor(y+height/2),speed*3,-5,0,damage,side);canvas.append(bullets[size++]);bullets[size]=new Bullet(x+width,Math.floor(y+height/2),speed*3,0,0,damage,side);canvas.append(bullets[size++]);bullets[size]=new Bullet(x+width,Math.floor(y+height/2),speed*3,5,0,damage,side);canvas.append(bullets[size++])}else if(fireType==4){bullets[size]=new Bullet(x+width,Math.floor(y+height/2),speed*3,-5,0,damage,side);canvas.append(bullets[size++]);bullets[size]=new Bullet(x+width,Math.floor(y+height/2)+3,speed*3,0,0,damage,side);canvas.append(bullets[size++]);bullets[size]=new Bullet(x+width,Math.floor(y+height/2)-3,speed*3,0,0,damage,side);canvas.append(bullets[size++]);bullets[size]=new Bullet(x+width,Math.floor(y+height/2),speed*3,5,0,damage,side);canvas.append(bullets[size++])}else if(fireType==5){bullets[size]=new Bullet(x+width,Math.floor(y+height/2),speed*3,-5,1,damage,side);canvas.append(bullets[size++]);bullets[size]=new Bullet(x+width,Math.floor(y+height/2)+3,speed*3,0,1,damage,side);canvas.append(bullets[size++]);bullets[size]=new Bullet(x+width,Math.floor(y+height/2)-3,speed*3,0,1,damage,side);canvas.append(bullets[size++]);bullets[size]=new Bullet(x+width,Math.floor(y+height/2),speed*3,5,1,damage,side);canvas.append(bullets[size++])}setTimeout(function(){firing=false},fireDelay)};var keyHandler=function(){if(keys[13])fire();if(keys[65]||keys[97])x=Math.max(0,x-speed);if(keys[87]||keys[119])y=Math.max(0,y-speed);if(keys[68]||keys[100])x=Math.min(canvas.getWidth()-width,x+speed);if(keys[83]||keys[115])y=Math.min(canvas.getHeight()-height,y+speed)};(function(){fighter.append(image);fighter.css("left",x);fighter.css("top",y);$(document).keydown(function(event){keys[event.keyCode]=true});$(document).keyup(function(event){keys[event.keyCode]=false})})();this.animate=function(){for(var index in bullets)if(!bullets[index].isVisible())delete bullets[index];keyHandler();fighter.css("top",y);fighter.css("left",x)};this.getDomObject=function(){return fighter};this.isVisible=function(){return visible};this.getType=function(){return"StarFighter"};var kill=function(){fighter.remove();visible=false;canvas.append(new Explosion(x+Math.floor(width/2)-16,y+Math.floor(height/2)-16,function(){new TitleScreen}))};this.kill=kill;this.getDimensions=function(){return{0:new Rectangle(y,y+height,x,x+width/3),1:new Triangle(new Point(x+width/3,y),new Point(x+width,y+height/2),new Point(x+width/3,y+height))}};this.getBullets=function(){return bullets};this.setPowerUp=function(powerUp){if(powerUp.getPowerUpType()=="Speed")speed=Math.min(speed+1,10);else if(powerUp.getPowerUpType()=="Bomb"){var enemies=canvas.getObjects("Enemy");for(var index in enemies)enemies[index].kill()}else if(powerUp.getPowerUpType()=="Fire")fireType=(fireType+1)%6};this.damage=function(damage){health-=damage;if(health<=0)kill()};this.getSide=function(){return side};this.addScore=function(points){score+=points};this.getScore=function(){return score};this.getHealthAsPercentage=function(){return Math.floor(health/parseFloat(maxHealth)*100)}}var titleBarHeight=32;function TitleBar(){var titleBar=$("<div class='TitleBar'></div>");var score=$("<div class='Score'></div>");var health=$("<div class='Health'></div>");var visible=false;var currentScore=0;var currentHealth=100;(function(){visible=true;titleBar.css("position","relative");titleBar.css("clear","both");titleBar.css("background","url('"+URL+"TitleBar.png')");titleBar.css("width",canvas.getWidth()+"px");titleBar.css("height",titleBarHeight+"px");score.css("font-size","20px");score.css("line-height",titleBarHeight+"px");score.css("height",titleBarHeight+"px");score.css("float","left");score.css("width","200px");health.css("font-size","20px");health.css("line-height",titleBarHeight+"px");health.css("float","left");health.css("height",titleBarHeight+"px");health.css("width","200px");titleBar.append(score);titleBar.append(health);$(mainContainer).prepend(titleBar)})();this.animate=function(){var starFighter=canvas.getObject("StarFighter");if(starFighter==null){health.html("Health: 0%");return}currentScore=starFighter.getScore();currentHealth=starFighter.getHealthAsPercentage();score.html("Score: "+currentScore);health.html("Health: "+currentHealth+"%")};var remove=function(){visible=false;score.remove();score=null;health.remove();health=null;titleBar.remove();titleBar=null};this.getDomObject=function(){return titleBar};this.isVisible=function(){return visible};this.getType=function(){return"TitleBar"};this.destroy=remove}function TitleScreen(){(function(){$(mainContainer).html("");if(canvas!=null)canvas.killAll();canvas=new Canvas(RESOLUTION_WIDTH,RESOLUTION_HEIGHT+titleBarHeight);new Stars(canvas);canvas.append(new Font(new Point(100,100),"Star Fighter (JavaScript)",30,{color:"#FFFFFF","font-weight":"bold"}));canvas.append(new Font(new Point(150,200),"New Game",15,{color:"#FFFFFF"},function(){$(mainContainer).html("");new Game}))})()}function Triangle(point1,point2,point3){var me=this;var point1=point1;var point2=point2;var point3=point3;var isColiding=function(shape){var type=shape.getType();if(type!="Point"){var points=getPoints();for(var point in points)if(shape.intersects(points[point]))return true}if(type=="Rectangle"||type=="Triangle"){var points=shape.getPoints();for(var point in points)if(isColiding(points[point]))return true}else if(type=="Cricle")return shape.intersects(me);else if(type=="Point"){var points=getPoints();for(var origin in points){var o=parseInt(origin);var pointA=(o+1)%3;var pointB=(o+2)%3;var a1=points[o].getX()-points[pointA].getX();var a2=points[o].getY()-points[pointA].getY();var a=new Vector(a1,a2,0);var b1=points[o].getX()-points[pointB].getX();var b2=points[o].getY()-points[pointB].getY();var b=new Vector(b1,b2,0);var c1=points[o].getX()-shape.getX();var c2=points[o].getY()-shape.getY();var c=new Vector(c1,c2,0);var directionAB=getNormalDirection(a,b);var directionAC=getNormalDirection(a,c);if(directionAC!=directionAB)return false}return true}return false};this.intersects=isColiding;this.getType=function(){return"Triangle"};var getPoints=function(){return{0:point1,1:point2,2:point3}};this.getPoints=getPoints}function cross(u,v){var u1=u.getX();var u2=u.getY();var u3=u.getZ();var v1=v.getX();var v2=v.getY();var v3=v.getZ();return new Vector(u2*v3-u3*v2,u3*v1-u1*v3,u1*v2-u2*v1)}function getNormalDirection(u,v){var u1=u.getX();var u2=u.getY();var v1=v.getX();var v2=v.getY();return u1*v2-u2*v1>=0}function Vector(x,y,z){var x=x;var y=y;var z=0;this.getType=function(){return"Vector"};this.getX=function(){return x};this.getY=function(){return y};this.getZ=function(){return z};this.toString=function(){return"\nVector:\n \tx: "+x+" y: "+y+" z: "+z}}var enemyList={0:{x:"100",y:"200",type:"0"},1:{x:"250",y:"100",type:"0"},2:{x:"250",y:"300",type:"0"},3:{x:"400",y:"0",type:"0"},4:{x:"400",y:"450",type:"0"},5:{x:"400",y:"200",type:"0"},6:{x:"800",y:"350",type:"0"},7:{x:"850",y:"300",type:"0"},8:{x:"950",y:"250",type:"0"},9:{x:"950",y:"150",type:"0"},10:{x:"1000",y:"300",type:"0"},11:{x:"1000",y:"100",type:"0"},12:{x:"1050",y:"350",type:"0"},13:{x:"1250",y:"150",type:"0"},14:{x:"1300",y:"150",type:"0"},15:{x:"1350",y:"150",type:"0"},16:{x:"1450",y:"300",type:"0"},17:{x:"1550",y:"350",type:"0"},18:{x:"1650",y:"100",type:"1"},19:{x:"1700",y:"300",type:"1"},20:{x:"1800",y:"150",type:"1"},21:{x:"1950",y:"300",type:"2"},22:{x:"2050",y:"50",type:"2"},23:{x:"2100",y:"300",type:"2"},24:{x:"2000",y:"150",type:"2"},25:{x:"2400",y:"350",type:"0"},26:{x:"2550",y:"200",type:"0"},27:{x:"2650",y:"350",type:"0"},28:{x:"2800",y:"250",type:"0"},29:{x:"2850",y:"100",type:"1"},30:{x:"3050",y:"50",type:"1"},31:{x:"3150",y:"300",type:"1"},32:{x:"3450",y:"50",type:"0"},33:{x:"3450",y:"400",type:"0"},34:{x:"3650",y:"400",type:"0"},35:{x:"3650",y:"250",type:"0"},36:{x:"3650",y:"150",type:"0"},37:{x:"3650",y:"200",type:"1"},38:{x:"3650",y:"250",type:"1"},39:{x:"3650",y:"300",type:"1"},40:{x:"3750",y:"250",type:"2"},41:{x:"3950",y:"200",type:"2"},42:{x:"4050",y:"300",type:"2"},43:{x:"4150",y:"50",type:"2"},44:{x:"4550",y:"300",type:"2"},45:{x:"4950",y:"200",type:"2"},46:{x:"5100",y:"350",type:"2"},47:{x:"5200",y:"150",type:"2"},48:{x:"5400",y:"0",type:"0"},49:{x:"5400",y:"50",type:"0"},50:{x:"5400",y:"100",type:"0"},51:{x:"5400",y:"150",type:"0"},52:{x:"5400",y:"200",type:"0"},53:{x:"5400",y:"250",type:"0"},54:{x:"5400",y:"300",type:"0"},55:{x:"5400",y:"350",type:"0"},56:{x:"5400",y:"400",type:"0"},57:{x:"5400",y:"450",type:"0"},58:{x:"5450",y:"0",type:"0"},59:{x:"5450",y:"50",type:"0"},60:{x:"5450",y:"100",type:"0"},61:{x:"5450",y:"150",type:"0"},62:{x:"5450",y:"200",type:"0"},63:{x:"5450",y:"250",type:"0"},64:{x:"5450",y:"300",type:"0"},65:{x:"5450",y:"350",type:"0"},66:{x:"5450",y:"400",type:"0"},67:{x:"5450",y:"450",type:"0"},68:{x:"5500",y:"250",type:"0"},69:{x:"5550",y:"200",type:"0"},70:{x:"5600",y:"250",type:"0"},71:{x:"5650",y:"200",type:"0"},72:{x:"5700",y:"250",type:"0"},73:{x:"5750",y:"200",type:"0"},74:{x:"5800",y:"250",type:"0"},75:{x:"5850",y:"200",type:"0"},76:{x:"5900",y:"0",type:"1"},77:{x:"5900",y:"50",type:"1"},78:{x:"5900",y:"100",type:"1"},79:{x:"5900",y:"150",type:"1"},80:{x:"5900",y:"200",type:"1"},81:{x:"5900",y:"250",type:"1"},82:{x:"5900",y:"300",type:"1"},83:{x:"5900",y:"350",type:"1"},84:{x:"5900",y:"400",type:"1"},85:{x:"5900",y:"450",type:"1"},86:{x:"5950",y:"0",type:"2"},87:{x:"5950",y:"50",type:"2"},88:{x:"5950",y:"100",type:"2"},89:{x:"5950",y:"150",type:"2"},90:{x:"5950",y:"200",type:"2"},91:{x:"5950",y:"250",type:"2"},92:{x:"5950",y:"300",type:"2"},93:{x:"5950",y:"350",type:"2"},94:{x:"5950",y:"400",type:"2"},95:{x:"5950",y:"450",type:"2"}};